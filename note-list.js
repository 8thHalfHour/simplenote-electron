(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["note-list"],{

/***/ "./icons/feed.jsx":
/*!************************!*\
  !*** ./icons/feed.jsx ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"default\", function() { return FeedIcon; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"../node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n\nfunction FeedIcon() {\n  return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"svg\", {\n    className: \"icon-feed\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    width: \"22\",\n    height: \"22\",\n    viewBox: \"0 0 24 24\"\n  }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"path\", {\n    d: \"M2,8.667V12c5.515,0,10,4.485,10,10h3.333C15.333,14.637,9.363,8.667,2,8.667z M2,2v3.333 c9.19,0,16.667,7.477,16.667,16.667H22C22,10.955,13.045,2,2,2z M4.5,17C3.118,17,2,18.12,2,19.5S3.118,22,4.5,22S7,20.88,7,19.5 S5.882,17,4.5,17z\"\n  }));\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9pY29ucy9mZWVkLmpzeC5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL2ljb25zL2ZlZWQuanN4P2I5YjQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRmVlZEljb24oKSB7XG4gIHJldHVybiAoXG4gICAgPHN2Z1xuICAgICAgY2xhc3NOYW1lPVwiaWNvbi1mZWVkXCJcbiAgICAgIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIlxuICAgICAgd2lkdGg9XCIyMlwiXG4gICAgICBoZWlnaHQ9XCIyMlwiXG4gICAgICB2aWV3Qm94PVwiMCAwIDI0IDI0XCJcbiAgICA+XG4gICAgICA8cGF0aCBkPVwiTTIsOC42NjdWMTJjNS41MTUsMCwxMCw0LjQ4NSwxMCwxMGgzLjMzM0MxNS4zMzMsMTQuNjM3LDkuMzYzLDguNjY3LDIsOC42Njd6IE0yLDJ2My4zMzNcblx0XHRcdFx0YzkuMTksMCwxNi42NjcsNy40NzcsMTYuNjY3LDE2LjY2N0gyMkMyMiwxMC45NTUsMTMuMDQ1LDIsMiwyeiBNNC41LDE3QzMuMTE4LDE3LDIsMTguMTIsMiwxOS41UzMuMTE4LDIyLDQuNSwyMlM3LDIwLjg4LDcsMTkuNVxuXHRcdFx0XHRTNS44ODIsMTcsNC41LDE3elwiIC8+XG4gICAgPC9zdmc+XG4gICk7XG59XG4iXSwibWFwcGluZ3MiOiJBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQUtBIiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./icons/feed.jsx\n");

/***/ }),

/***/ "./note-list/get-note-title-and-preview.js":
/*!*************************************************!*\
  !*** ./note-list/get-note-title-and-preview.js ***!
  \*************************************************/
/*! exports provided: withCache, clearCache, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"withCache\", function() { return withCache; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clearCache\", function() { return clearCache; });\n/* harmony import */ var _utils_note_utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils/note-utils */ \"./utils/note-utils.js\");\n\n/** @type {Map} stores a cache of computed note preview excerpts to prevent re-truncating note content */\n\nvar noteCache = new Map();\n/**\n * Caches based on note id\n *\n * @param {Function} getKey Get the key used for invalidating the cache\n * @param {Function} getValue Get the value for the cache\n * @returns {Object} note title and preview excerpt\n */\n\nvar withCache = function withCache(getKey, getValue) {\n  return function (note) {\n    var cached = noteCache.get(note.id);\n    var key = getKey(note);\n\n    if ('undefined' === typeof cached || key !== cached.key) {\n      var newCacheObj = {\n        key: key,\n        value: getValue(note)\n      };\n      noteCache.set(note.id, newCacheObj);\n      cached = newCacheObj;\n    }\n\n    return cached.value;\n  };\n};\nvar clearCache = function clearCache() {\n  return noteCache.clear();\n};\nvar getNoteTitleAndPreview = withCache(function (note) {\n  return note.data.modificationDate;\n}, _utils_note_utils__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n/* harmony default export */ __webpack_exports__[\"default\"] = (getNoteTitleAndPreview);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub3RlLWxpc3QvZ2V0LW5vdGUtdGl0bGUtYW5kLXByZXZpZXcuanMuanMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9ub3RlLWxpc3QvZ2V0LW5vdGUtdGl0bGUtYW5kLXByZXZpZXcuanM/MWIwYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZ2V0Tm90ZUV4Y2VycHQgZnJvbSAnLi4vdXRpbHMvbm90ZS11dGlscyc7XG5cbi8qKiBAdHlwZSB7TWFwfSBzdG9yZXMgYSBjYWNoZSBvZiBjb21wdXRlZCBub3RlIHByZXZpZXcgZXhjZXJwdHMgdG8gcHJldmVudCByZS10cnVuY2F0aW5nIG5vdGUgY29udGVudCAqL1xuY29uc3Qgbm90ZUNhY2hlID0gbmV3IE1hcCgpO1xuXG4vKipcbiAqIENhY2hlcyBiYXNlZCBvbiBub3RlIGlkXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZ2V0S2V5IEdldCB0aGUga2V5IHVzZWQgZm9yIGludmFsaWRhdGluZyB0aGUgY2FjaGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGdldFZhbHVlIEdldCB0aGUgdmFsdWUgZm9yIHRoZSBjYWNoZVxuICogQHJldHVybnMge09iamVjdH0gbm90ZSB0aXRsZSBhbmQgcHJldmlldyBleGNlcnB0XG4gKi9cbmV4cG9ydCBjb25zdCB3aXRoQ2FjaGUgPSAoZ2V0S2V5LCBnZXRWYWx1ZSkgPT4gbm90ZSA9PiB7XG4gIGxldCBjYWNoZWQgPSBub3RlQ2FjaGUuZ2V0KG5vdGUuaWQpO1xuICBjb25zdCBrZXkgPSBnZXRLZXkobm90ZSk7XG5cbiAgaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgY2FjaGVkIHx8IGtleSAhPT0gY2FjaGVkLmtleSkge1xuICAgIGNvbnN0IG5ld0NhY2hlT2JqID0geyBrZXksIHZhbHVlOiBnZXRWYWx1ZShub3RlKSB9O1xuICAgIG5vdGVDYWNoZS5zZXQobm90ZS5pZCwgbmV3Q2FjaGVPYmopO1xuICAgIGNhY2hlZCA9IG5ld0NhY2hlT2JqO1xuICB9XG4gIHJldHVybiBjYWNoZWQudmFsdWU7XG59O1xuXG5leHBvcnQgY29uc3QgY2xlYXJDYWNoZSA9ICgpID0+IG5vdGVDYWNoZS5jbGVhcigpO1xuXG5jb25zdCBnZXROb3RlVGl0bGVBbmRQcmV2aWV3ID0gd2l0aENhY2hlKFxuICBub3RlID0+IG5vdGUuZGF0YS5tb2RpZmljYXRpb25EYXRlLFxuICBnZXROb3RlRXhjZXJwdFxuKTtcblxuZXhwb3J0IGRlZmF1bHQgZ2V0Tm90ZVRpdGxlQW5kUHJldmlldztcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUVBOzs7Ozs7OztBQU9BO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBVkE7QUFZQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFJQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./note-list/get-note-title-and-preview.js\n");

/***/ }),

/***/ "./note-list/index.jsx":
/*!*****************************!*\
  !*** ./note-list/index.jsx ***!
  \*****************************/
/*! exports provided: NoteList, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"NoteList\", function() { return NoteList; });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ \"../node_modules/react/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! prop-types */ \"../node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_virtualized__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-virtualized */ \"../node_modules/react-virtualized/dist/es/index.js\");\n/* harmony import */ var _icons_feed__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../icons/feed */ \"./icons/feed.jsx\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! classnames */ \"../node_modules/classnames/index.js\");\n/* harmony import */ var classnames__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(classnames__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! lodash */ \"../node_modules/lodash/lodash.js\");\n/* harmony import */ var lodash__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(lodash__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react-redux */ \"../node_modules/react-redux/es/index.js\");\n/* harmony import */ var _flux_app_state__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../flux/app-state */ \"./flux/app-state.js\");\n/* harmony import */ var _analytics__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../analytics */ \"./analytics/index.js\");\n/* harmony import */ var _analytics__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(_analytics__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var _utils_filter_notes__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../utils/filter-notes */ \"./utils/filter-notes.js\");\n/* harmony import */ var _get_note_title_and_preview__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./get-note-title-and-preview */ \"./note-list/get-note-title-and-preview.js\");\nfunction _typeof(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/**\n * @module NoteList\n *\n * This module includes some ugly code.\n * The note list display is a significant source of\n * visual re-render lag for accounts with many notes.\n * The trade-offs in this file reflect a decision to\n * optimize heavy inner loops for performance over\n * code burden.\n *\n * Any changes to this code which could affect the\n * row height calculations should be double-checked\n * against performance regressions.\n */\n\n\n\n\n\n\n\n\n\n\n\nreact_virtualized__WEBPACK_IMPORTED_MODULE_2__[\"AutoSizer\"].displayName = 'AutoSizer';\nreact_virtualized__WEBPACK_IMPORTED_MODULE_2__[\"List\"].displayName = 'List';\n/**\n * Delay for preventing row height calculation thrashing\n *\n * this constant was determined experimentally\n * and is open to adjustment if it doesn't find\n * the proper balance between visual updates\n * and performance impacts recomputing row heights\n *\n * @type {Number} minimum number of ms between calls to recomputeRowHeights in virtual/list\n */\n\nvar TYPING_DEBOUNCE_DELAY = 70;\n/**\n * Maximum delay when debouncing the row height calculation\n *\n * this is used to make sure that we don't endlessly delay\n * the row height recalculation in situations like when we\n * are constantly typing without pause. by setting this value\n * we can make sure that the updates don't happen\n * less-frequently than the number of ms set here\n *\n * @type {Number} maximum number of ms between calls when debouncing recomputeRowHeights in virtual/list\n */\n\nvar TYPING_DEBOUNCE_MAX = 1000;\n/** @type {Number} height of title + vertical padding in list rows */\n\nvar ROW_HEIGHT_BASE = 24 + 18;\n/** @type {Number} height of one row of preview text in list rows */\n\nvar ROW_HEIGHT_LINE = 21;\n/** @type {Object.<String, Number>} maximum number of lines to display in list rows for display mode */\n\nvar maxPreviewLines = {\n  comfy: 1,\n  condensed: 0,\n  expanded: 4\n};\n/**\n * Uses canvas.measureText to compute and return the width of the given text of given font in pixels.\n *\n * @see http://stackoverflow.com/questions/118241/calculate-text-width-with-javascript/21015393#21015393\n *\n * @param {String} text The text to be rendered.\n * @param {String} width width of the containing area in which the text is rendered\n * @returns {number} width of rendered text in pixels\n */\n\nfunction getTextWidth(text, width) {\n  var canvas = getTextWidth.canvas || (getTextWidth.canvas = document.createElement('canvas'));\n  canvas.width = width;\n  var context = canvas.getContext('2d');\n  context.font = '16px arial';\n  return context.measureText(text).width;\n}\n/** @type {Map} stores a cache of computed row heights to prevent re-rendering the canvas calculation */\n\n\nvar previewCache = new Map();\n/**\n * Caches based on note id, width, note display format, and note preview excerpt\n *\n * @param {Function} f produces the row height\n * @returns {Number} row height for note in list\n */\n\nvar rowHeightCache = function rowHeightCache(f) {\n  return function (notes, _ref) {\n    var noteDisplay = _ref.noteDisplay,\n        width = _ref.width;\n    return function (_ref2) {\n      var index = _ref2.index;\n      var note = notes[index];\n\n      var _getNoteTitleAndPrevi = Object(_get_note_title_and_preview__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(note),\n          preview = _getNoteTitleAndPrevi.preview;\n\n      var key = notes[index].id;\n      var cached = previewCache.get(key);\n\n      if ('undefined' !== typeof cached) {\n        var _cached = _slicedToArray(cached, 4),\n            cWidth = _cached[0],\n            cNoteDisplay = _cached[1],\n            cPreview = _cached[2],\n            cHeight = _cached[3];\n\n        if (cWidth === width && cNoteDisplay === noteDisplay && cPreview === preview) {\n          return cHeight;\n        }\n      }\n\n      var height = f(width, noteDisplay, preview);\n      previewCache.set(key, [width, noteDisplay, preview, height]);\n      return height;\n    };\n  };\n};\n/**\n * Computes the pixel height of a row for a given preview text in the list\n *\n * @param {Number} width how wide the list renders\n * @param {String} noteDisplay mode of list display: 'comfy', 'condensed', or 'expanded'\n * @param {String} preview preview snippet from note\n * @returns {Number} height of the row in the list\n */\n\n\nvar computeRowHeight = function computeRowHeight(width, noteDisplay, preview) {\n  var lines = Math.ceil(getTextWidth(preview, width - 24) / (width - 24));\n  return ROW_HEIGHT_BASE + ROW_HEIGHT_LINE * Math.min(maxPreviewLines[noteDisplay], lines);\n};\n/**\n * Estimates the pixel height of a given row in the note list\n *\n * This function utilizes a cache to prevent rerendering the text into a canvas\n * @see rowHeightCache\n *\n * @function\n */\n\n\nvar getRowHeight = rowHeightCache(computeRowHeight);\n/**\n * Splits a text segment by a RegExp and indicates which pieces are matches\n *\n * This is a recursive function and therefore inherently carries with it the\n * risk of stack overflow. However, we can reasonably guard against this because\n * our level of recursion should be practically limited by the length of the\n * notes and the frequency of search terms.\n *\n * Nonetheless we will hard limit it just in case.\n *\n * @param {RegExp} filter used to split the text\n * @param {Number} sliceLength length of original search text\n * @param {String} text text to split\n * @param {(Object<String, String>)[]} [splits=[]] list of split segments\n * @param {Number} [maxDepth=1000] limits the number of matches and prevents stack overflow on recursion\n * @returns {(Object<String, String>)[]} split segments with type indications\n */\n\nvar splitWith = function splitWith(filter, sliceLength, text) {\n  var splits = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];\n  var maxDepth = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : 1000;\n\n  // prevent splitting a string when the filter is empty\n  // because this could easily cause stack-overflow\n  if (!sliceLength || !maxDepth) {\n    return _toConsumableArray(splits).concat([{\n      type: 'text',\n      text: text\n    }]);\n  }\n\n  var index = text.search(filter);\n  return index === -1 ? _toConsumableArray(splits).concat([{\n    type: 'text',\n    text: text\n  }]) : splitWith(filter, // pass along the original filter\n  sliceLength, // and the original slice length\n  text.slice(index + sliceLength), // text _following_ the match\n  _toConsumableArray(splits).concat([// the existing segments\n  {\n    type: 'text',\n    text: text.slice(0, index)\n  }, // text _before_ the match\n  {\n    type: 'match',\n    text: text.slice(index, index + sliceLength)\n  }]), maxDepth - 1 // prevent stack overflow on recursion\n  );\n};\n/**\n * Wraps \"match\" segments with appropriate CSS\n *\n * @param {String[]} splits segments of split text with type indication\n * @returns {Object[]} the wrapped segments\n */\n\n\nvar matchify = function matchify(splits) {\n  return splits.map(function (_ref3, index) {\n    var type = _ref3.type,\n        text = _ref3.text;\n    return type === 'match' ? react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n      key: index,\n      className: \"search-match\"\n    }, text) : react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n      key: index\n    }, text);\n  });\n};\n/**\n * Renders an individual row in the note list\n *\n * @see react-virtual/list\n *\n * @param {Object[]} notes list of filtered notes\n * @param {String} filter search filter\n * @param {RegExp} filterRegExp RegExp version of filter\n * @param {String} noteDisplay list view style: comfy, condensed, expanded\n * @param {Number} selectedNoteId id of currently selected note\n * @param {Function} onSelectNote used to change the current note selection\n * @param {Function} onPinNote used to pin a note to the top of the list\n * @returns {Function} does the actual rendering for the List\n */\n\n\nvar renderNote = function renderNote(notes, _ref4) {\n  var filter = _ref4.filter,\n      filterRegExp = _ref4.filterRegExp,\n      noteDisplay = _ref4.noteDisplay,\n      selectedNoteId = _ref4.selectedNoteId,\n      onNoteOpened = _ref4.onNoteOpened,\n      onSelectNote = _ref4.onSelectNote,\n      onPinNote = _ref4.onPinNote,\n      isSmallScreen = _ref4.isSmallScreen;\n  return function (_ref5) {\n    var index = _ref5.index,\n        rowIndex = _ref5.rowIndex,\n        key = _ref5.key,\n        style = _ref5.style;\n    var note = notes['undefined' === typeof index ? rowIndex : index];\n\n    var _getNoteTitleAndPrevi2 = Object(_get_note_title_and_preview__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(note),\n        title = _getNoteTitleAndPrevi2.title,\n        preview = _getNoteTitleAndPrevi2.preview;\n\n    var isPublished = !Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"isEmpty\"])(note.data.publishURL);\n    var showPublishIcon = isPublished && 'condensed' !== noteDisplay;\n    var classes = classnames__WEBPACK_IMPORTED_MODULE_4___default()('note-list-item', {\n      'note-list-item-selected': !isSmallScreen && selectedNoteId === note.id,\n      'note-list-item-pinned': note.pinned,\n      'published-note': isPublished\n    });\n    var titleSplits = filter.length > 0 ? splitWith(filterRegExp, filter.length, title) : [{\n      type: 'text',\n      text: title\n    }];\n    var previewSplits = filter.length > 0 ? splitWith(filterRegExp, filter.length, preview) : [{\n      type: 'text',\n      text: preview\n    }];\n\n    var selectNote = function selectNote() {\n      onSelectNote(note.id);\n      onNoteOpened();\n    };\n\n    return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      key: key,\n      style: style,\n      className: classes\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"note-list-item-pinner\",\n      tabIndex: \"0\",\n      onClick: onPinNote.bind(null, note)\n    }), react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"note-list-item-text theme-color-border\",\n      tabIndex: \"0\",\n      onClick: selectNote\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"note-list-item-title\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", null, matchify(titleSplits)), showPublishIcon && react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"note-list-item-published-icon\"\n    }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(_icons_feed__WEBPACK_IMPORTED_MODULE_3__[\"default\"], null))), 'condensed' !== noteDisplay && preview.trim() && react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n      className: \"note-list-item-excerpt\"\n    }, matchify(previewSplits))));\n  };\n};\n\nvar NoteList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(NoteList, _Component);\n\n  function NoteList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, NoteList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(NoteList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"handleShortcut\", function (event) {\n      var ctrlKey = event.ctrlKey,\n          key = event.key,\n          metaKey = event.metaKey,\n          shiftKey = event.shiftKey;\n      var cmdOrCtrl = ctrlKey || metaKey;\n\n      if (cmdOrCtrl && shiftKey && (key === 'ArrowUp' || key === 'K')) {\n        _this.props.onSelectNote(_this.props.nextNote.id);\n\n        event.stopPropagation();\n        event.preventDefault();\n        return false;\n      }\n\n      if (cmdOrCtrl && shiftKey && (key === 'ArrowDown' || key === 'J')) {\n        _this.props.onSelectNote(_this.props.prevNote.id);\n\n        event.stopPropagation();\n        event.preventDefault();\n        return false;\n      }\n\n      return true;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"refList\", function (r) {\n      return _this.list = r;\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"toggleShortcuts\", function (doEnable) {\n      if (doEnable) {\n        window.addEventListener('keydown', _this.handleShortcut, true);\n      } else {\n        window.removeEventListener('keydown', _this.handleShortcut, true);\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_assertThisInitialized(_this)), \"onPinNote\", function (note) {\n      return _this.props.onPinNote(note, !note.pinned);\n    });\n\n    return _this;\n  }\n\n  _createClass(NoteList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      /**\n       * Prevents rapid changes from incurring major\n       * performance hits due to row height computation\n       */\n      this.recomputeHeights = Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"debounce\"])(function () {\n        return _this2.list && _this2.list.recomputeRowHeights();\n      }, TYPING_DEBOUNCE_DELAY, {\n        maxWait: TYPING_DEBOUNCE_MAX\n      });\n      this.toggleShortcuts(true);\n      window.addEventListener('resize', this.recomputeHeights);\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (prevProps.noteDisplay !== this.props.noteDisplay || prevProps.notes !== this.props.notes || prevProps.selectedNoteContent !== this.props.selectedNoteContent) {\n        this.recomputeHeights();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.toggleShortcuts(false);\n      window.removeEventListener('resize', this.recomputeHeights);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$props = this.props,\n          filter = _this$props.filter,\n          selectedNoteId = _this$props.selectedNoteId,\n          onNoteOpened = _this$props.onNoteOpened,\n          onSelectNote = _this$props.onSelectNote,\n          onEmptyTrash = _this$props.onEmptyTrash,\n          noteDisplay = _this$props.noteDisplay,\n          showTrash = _this$props.showTrash,\n          notes = _this$props.notes,\n          isSmallScreen = _this$props.isSmallScreen;\n      var filterRegExp = new RegExp(Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"escapeRegExp\"])(filter), 'gi');\n      var listItemsClasses = classnames__WEBPACK_IMPORTED_MODULE_4___default()('note-list-items', noteDisplay);\n      var renderNoteRow = renderNote(notes, {\n        filter: filter,\n        filterRegExp: filterRegExp,\n        noteDisplay: noteDisplay,\n        onNoteOpened: onNoteOpened,\n        onSelectNote: onSelectNote,\n        onPinNote: this.onPinNote,\n        selectedNoteId: selectedNoteId,\n        isSmallScreen: isSmallScreen\n      });\n      var isEmptyList = notes.length === 0;\n      var emptyTrashButton = react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: \"note-list-empty-trash theme-color-border\"\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"button\", {\n        type: \"button\",\n        className: \"button button-borderless button-danger\",\n        onClick: onEmptyTrash\n      }, \"Empty Trash\"));\n      return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: classnames__WEBPACK_IMPORTED_MODULE_4___default()('note-list', {\n          'is-empty': isEmptyList\n        })\n      }, isEmptyList ? react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"span\", {\n        className: \"note-list-placeholder\"\n      }, \"No Notes\") : react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react__WEBPACK_IMPORTED_MODULE_0__[\"Fragment\"], null, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(\"div\", {\n        className: listItemsClasses\n      }, react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_virtualized__WEBPACK_IMPORTED_MODULE_2__[\"AutoSizer\"], null, function (_ref6) {\n        var height = _ref6.height,\n            width = _ref6.width;\n        return react__WEBPACK_IMPORTED_MODULE_0___default.a.createElement(react_virtualized__WEBPACK_IMPORTED_MODULE_2__[\"List\"], {\n          ref: _this3.refList,\n          estimatedRowSize: ROW_HEIGHT_BASE + ROW_HEIGHT_LINE * maxPreviewLines[noteDisplay],\n          height: height,\n          noteDisplay: noteDisplay,\n          notes: _this3.props.notes,\n          rowCount: _this3.props.notes.length,\n          rowHeight: 'condensed' === noteDisplay ? ROW_HEIGHT_BASE : getRowHeight(_this3.props.notes, {\n            noteDisplay: noteDisplay,\n            width: width\n          }),\n          rowRenderer: renderNoteRow,\n          width: width\n        });\n      })), !!showTrash && emptyTrashButton));\n    }\n  }]);\n\n  return NoteList;\n}(react__WEBPACK_IMPORTED_MODULE_0__[\"Component\"]);\n\n_defineProperty(NoteList, \"displayName\", 'NoteList');\n\n_defineProperty(NoteList, \"propTypes\", {\n  isSmallScreen: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool.isRequired,\n  notes: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.array.isRequired,\n  selectedNoteId: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.any,\n  onNoteOpened: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func.isRequired,\n  onSelectNote: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func.isRequired,\n  onPinNote: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.func.isRequired,\n  noteDisplay: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.string.isRequired,\n  onEmptyTrash: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.any.isRequired,\n  showTrash: prop_types__WEBPACK_IMPORTED_MODULE_1___default.a.bool\n});\n\nvar _appState$actionCreat = _flux_app_state__WEBPACK_IMPORTED_MODULE_7__[\"default\"].actionCreators,\n    emptyTrash = _appState$actionCreat.emptyTrash,\n    loadAndSelectNote = _appState$actionCreat.loadAndSelectNote,\n    pinNote = _appState$actionCreat.pinNote;\nvar recordEvent = _analytics__WEBPACK_IMPORTED_MODULE_8__[\"tracks\"].recordEvent;\n\nvar mapStateToProps = function mapStateToProps(_ref7) {\n  var state = _ref7.appState,\n      noteDisplay = _ref7.settings.noteDisplay;\n  var filteredNotes = Object(_utils_filter_notes__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(state);\n  var noteIndex = Math.max(state.previousIndex, 0);\n  var selectedNote = state.note ? state.note : filteredNotes[noteIndex];\n  var selectedNoteId = Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"get\"])(selectedNote, 'id', state.selectedNoteId);\n  var selectedNoteIndex = filteredNotes.findIndex(function (_ref8) {\n    var id = _ref8.id;\n    return id === selectedNoteId;\n  });\n  var nextNoteId = Math.max(0, selectedNoteIndex - 1);\n  var prevNoteId = Math.min(filteredNotes.length - 1, selectedNoteIndex + 1);\n  var nextNote = filteredNotes[nextNoteId];\n  var prevNote = filteredNotes[prevNoteId];\n  /**\n   * Although not used directly in the React component this value\n   * is used to bust the cache when editing a note and the number\n   * of lines in the preview in the notes list needs to also update.\n   *\n   * React virtualized hides data in the DOM in a stateful way in\n   * the way it has optimized the scrolling performance. This then\n   * is missed when connect() decides whether or not to redraw the\n   * component. Even with `{ pure: false }` set in `connect()` it\n   * misses the updates and I think that is because they come in\n   * asynchronously through events and not directly\n   *\n   * Therefore we have to calculate the height of the note here to\n   * signal to `connect()` to redraw the component. This could also\n   * happen in `areStatesEqual()` (option to `connect()`) but since\n   * we're already grabbing the other data here we can skip a slight\n   * amount of overhead by just passing it along here.\n   *\n   * @type {String} preview excerpt for the current note\n   */\n\n  var selectedNotePreview = selectedNote && Object(_get_note_title_and_preview__WEBPACK_IMPORTED_MODULE_10__[\"default\"])(selectedNote).preview;\n  return {\n    filter: state.filter,\n    nextNote: nextNote,\n    noteDisplay: noteDisplay,\n    notes: filteredNotes,\n    prevNote: prevNote,\n    selectedNotePreview: selectedNotePreview,\n    selectedNoteContent: Object(lodash__WEBPACK_IMPORTED_MODULE_5__[\"get\"])(selectedNote, 'data.content'),\n    selectedNoteId: selectedNoteId,\n    showTrash: state.showTrash\n  };\n};\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch, _ref9) {\n  var noteBucket = _ref9.noteBucket;\n  return {\n    onEmptyTrash: function onEmptyTrash() {\n      return dispatch(emptyTrash({\n        noteBucket: noteBucket\n      }));\n    },\n    onSelectNote: function onSelectNote(noteId) {\n      dispatch(loadAndSelectNote({\n        noteBucket: noteBucket,\n        noteId: noteId\n      }));\n      recordEvent('list_note_opened');\n    },\n    onPinNote: function onPinNote(note, pin) {\n      return dispatch(pinNote({\n        noteBucket: noteBucket,\n        note: note,\n        pin: pin\n      }));\n    }\n  };\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Object(react_redux__WEBPACK_IMPORTED_MODULE_6__[\"connect\"])(mapStateToProps, mapDispatchToProps)(NoteList));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9ub3RlLWxpc3QvaW5kZXguanN4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vbm90ZS1saXN0L2luZGV4LmpzeD82NjNlIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQG1vZHVsZSBOb3RlTGlzdFxuICpcbiAqIFRoaXMgbW9kdWxlIGluY2x1ZGVzIHNvbWUgdWdseSBjb2RlLlxuICogVGhlIG5vdGUgbGlzdCBkaXNwbGF5IGlzIGEgc2lnbmlmaWNhbnQgc291cmNlIG9mXG4gKiB2aXN1YWwgcmUtcmVuZGVyIGxhZyBmb3IgYWNjb3VudHMgd2l0aCBtYW55IG5vdGVzLlxuICogVGhlIHRyYWRlLW9mZnMgaW4gdGhpcyBmaWxlIHJlZmxlY3QgYSBkZWNpc2lvbiB0b1xuICogb3B0aW1pemUgaGVhdnkgaW5uZXIgbG9vcHMgZm9yIHBlcmZvcm1hbmNlIG92ZXJcbiAqIGNvZGUgYnVyZGVuLlxuICpcbiAqIEFueSBjaGFuZ2VzIHRvIHRoaXMgY29kZSB3aGljaCBjb3VsZCBhZmZlY3QgdGhlXG4gKiByb3cgaGVpZ2h0IGNhbGN1bGF0aW9ucyBzaG91bGQgYmUgZG91YmxlLWNoZWNrZWRcbiAqIGFnYWluc3QgcGVyZm9ybWFuY2UgcmVncmVzc2lvbnMuXG4gKi9cbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQsIEZyYWdtZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IEF1dG9TaXplciwgTGlzdCB9IGZyb20gJ3JlYWN0LXZpcnR1YWxpemVkJztcbmltcG9ydCBQdWJsaXNoSWNvbiBmcm9tICcuLi9pY29ucy9mZWVkJztcbmltcG9ydCBjbGFzc05hbWVzIGZyb20gJ2NsYXNzbmFtZXMnO1xuaW1wb3J0IHsgZGVib3VuY2UsIGVzY2FwZVJlZ0V4cCwgZ2V0LCBpc0VtcHR5IH0gZnJvbSAnbG9kYXNoJztcbmltcG9ydCB7IGNvbm5lY3QgfSBmcm9tICdyZWFjdC1yZWR1eCc7XG5pbXBvcnQgYXBwU3RhdGUgZnJvbSAnLi4vZmx1eC9hcHAtc3RhdGUnO1xuaW1wb3J0IHsgdHJhY2tzIH0gZnJvbSAnLi4vYW5hbHl0aWNzJztcbmltcG9ydCBmaWx0ZXJOb3RlcyBmcm9tICcuLi91dGlscy9maWx0ZXItbm90ZXMnO1xuaW1wb3J0IGdldE5vdGVUaXRsZUFuZFByZXZpZXcgZnJvbSAnLi9nZXQtbm90ZS10aXRsZS1hbmQtcHJldmlldyc7XG5cbkF1dG9TaXplci5kaXNwbGF5TmFtZSA9ICdBdXRvU2l6ZXInO1xuTGlzdC5kaXNwbGF5TmFtZSA9ICdMaXN0JztcblxuLyoqXG4gKiBEZWxheSBmb3IgcHJldmVudGluZyByb3cgaGVpZ2h0IGNhbGN1bGF0aW9uIHRocmFzaGluZ1xuICpcbiAqIHRoaXMgY29uc3RhbnQgd2FzIGRldGVybWluZWQgZXhwZXJpbWVudGFsbHlcbiAqIGFuZCBpcyBvcGVuIHRvIGFkanVzdG1lbnQgaWYgaXQgZG9lc24ndCBmaW5kXG4gKiB0aGUgcHJvcGVyIGJhbGFuY2UgYmV0d2VlbiB2aXN1YWwgdXBkYXRlc1xuICogYW5kIHBlcmZvcm1hbmNlIGltcGFjdHMgcmVjb21wdXRpbmcgcm93IGhlaWdodHNcbiAqXG4gKiBAdHlwZSB7TnVtYmVyfSBtaW5pbXVtIG51bWJlciBvZiBtcyBiZXR3ZWVuIGNhbGxzIHRvIHJlY29tcHV0ZVJvd0hlaWdodHMgaW4gdmlydHVhbC9saXN0XG4gKi9cbmNvbnN0IFRZUElOR19ERUJPVU5DRV9ERUxBWSA9IDcwO1xuXG4vKipcbiAqIE1heGltdW0gZGVsYXkgd2hlbiBkZWJvdW5jaW5nIHRoZSByb3cgaGVpZ2h0IGNhbGN1bGF0aW9uXG4gKlxuICogdGhpcyBpcyB1c2VkIHRvIG1ha2Ugc3VyZSB0aGF0IHdlIGRvbid0IGVuZGxlc3NseSBkZWxheVxuICogdGhlIHJvdyBoZWlnaHQgcmVjYWxjdWxhdGlvbiBpbiBzaXR1YXRpb25zIGxpa2Ugd2hlbiB3ZVxuICogYXJlIGNvbnN0YW50bHkgdHlwaW5nIHdpdGhvdXQgcGF1c2UuIGJ5IHNldHRpbmcgdGhpcyB2YWx1ZVxuICogd2UgY2FuIG1ha2Ugc3VyZSB0aGF0IHRoZSB1cGRhdGVzIGRvbid0IGhhcHBlblxuICogbGVzcy1mcmVxdWVudGx5IHRoYW4gdGhlIG51bWJlciBvZiBtcyBzZXQgaGVyZVxuICpcbiAqIEB0eXBlIHtOdW1iZXJ9IG1heGltdW0gbnVtYmVyIG9mIG1zIGJldHdlZW4gY2FsbHMgd2hlbiBkZWJvdW5jaW5nIHJlY29tcHV0ZVJvd0hlaWdodHMgaW4gdmlydHVhbC9saXN0XG4gKi9cbmNvbnN0IFRZUElOR19ERUJPVU5DRV9NQVggPSAxMDAwO1xuXG4vKiogQHR5cGUge051bWJlcn0gaGVpZ2h0IG9mIHRpdGxlICsgdmVydGljYWwgcGFkZGluZyBpbiBsaXN0IHJvd3MgKi9cbmNvbnN0IFJPV19IRUlHSFRfQkFTRSA9IDI0ICsgMTg7XG5cbi8qKiBAdHlwZSB7TnVtYmVyfSBoZWlnaHQgb2Ygb25lIHJvdyBvZiBwcmV2aWV3IHRleHQgaW4gbGlzdCByb3dzICovXG5jb25zdCBST1dfSEVJR0hUX0xJTkUgPSAyMTtcblxuLyoqIEB0eXBlIHtPYmplY3QuPFN0cmluZywgTnVtYmVyPn0gbWF4aW11bSBudW1iZXIgb2YgbGluZXMgdG8gZGlzcGxheSBpbiBsaXN0IHJvd3MgZm9yIGRpc3BsYXkgbW9kZSAqL1xuY29uc3QgbWF4UHJldmlld0xpbmVzID0ge1xuICBjb21meTogMSxcbiAgY29uZGVuc2VkOiAwLFxuICBleHBhbmRlZDogNCxcbn07XG5cbi8qKlxuICogVXNlcyBjYW52YXMubWVhc3VyZVRleHQgdG8gY29tcHV0ZSBhbmQgcmV0dXJuIHRoZSB3aWR0aCBvZiB0aGUgZ2l2ZW4gdGV4dCBvZiBnaXZlbiBmb250IGluIHBpeGVscy5cbiAqXG4gKiBAc2VlIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTE4MjQxL2NhbGN1bGF0ZS10ZXh0LXdpZHRoLXdpdGgtamF2YXNjcmlwdC8yMTAxNTM5MyMyMTAxNTM5M1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSB0ZXh0IFRoZSB0ZXh0IHRvIGJlIHJlbmRlcmVkLlxuICogQHBhcmFtIHtTdHJpbmd9IHdpZHRoIHdpZHRoIG9mIHRoZSBjb250YWluaW5nIGFyZWEgaW4gd2hpY2ggdGhlIHRleHQgaXMgcmVuZGVyZWRcbiAqIEByZXR1cm5zIHtudW1iZXJ9IHdpZHRoIG9mIHJlbmRlcmVkIHRleHQgaW4gcGl4ZWxzXG4gKi9cbmZ1bmN0aW9uIGdldFRleHRXaWR0aCh0ZXh0LCB3aWR0aCkge1xuICBjb25zdCBjYW52YXMgPVxuICAgIGdldFRleHRXaWR0aC5jYW52YXMgfHxcbiAgICAoZ2V0VGV4dFdpZHRoLmNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2NhbnZhcycpKTtcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XG4gIGNvbnN0IGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbiAgY29udGV4dC5mb250ID0gJzE2cHggYXJpYWwnO1xuICByZXR1cm4gY29udGV4dC5tZWFzdXJlVGV4dCh0ZXh0KS53aWR0aDtcbn1cblxuLyoqIEB0eXBlIHtNYXB9IHN0b3JlcyBhIGNhY2hlIG9mIGNvbXB1dGVkIHJvdyBoZWlnaHRzIHRvIHByZXZlbnQgcmUtcmVuZGVyaW5nIHRoZSBjYW52YXMgY2FsY3VsYXRpb24gKi9cbmNvbnN0IHByZXZpZXdDYWNoZSA9IG5ldyBNYXAoKTtcblxuLyoqXG4gKiBDYWNoZXMgYmFzZWQgb24gbm90ZSBpZCwgd2lkdGgsIG5vdGUgZGlzcGxheSBmb3JtYXQsIGFuZCBub3RlIHByZXZpZXcgZXhjZXJwdFxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGYgcHJvZHVjZXMgdGhlIHJvdyBoZWlnaHRcbiAqIEByZXR1cm5zIHtOdW1iZXJ9IHJvdyBoZWlnaHQgZm9yIG5vdGUgaW4gbGlzdFxuICovXG5jb25zdCByb3dIZWlnaHRDYWNoZSA9IGYgPT4gKG5vdGVzLCB7IG5vdGVEaXNwbGF5LCB3aWR0aCB9KSA9PiAoeyBpbmRleCB9KSA9PiB7XG4gIGNvbnN0IG5vdGUgPSBub3Rlc1tpbmRleF07XG4gIGNvbnN0IHsgcHJldmlldyB9ID0gZ2V0Tm90ZVRpdGxlQW5kUHJldmlldyhub3RlKTtcblxuICBjb25zdCBrZXkgPSBub3Rlc1tpbmRleF0uaWQ7XG4gIGNvbnN0IGNhY2hlZCA9IHByZXZpZXdDYWNoZS5nZXQoa2V5KTtcblxuICBpZiAoJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBjYWNoZWQpIHtcbiAgICBjb25zdCBbY1dpZHRoLCBjTm90ZURpc3BsYXksIGNQcmV2aWV3LCBjSGVpZ2h0XSA9IGNhY2hlZDtcblxuICAgIGlmIChcbiAgICAgIGNXaWR0aCA9PT0gd2lkdGggJiZcbiAgICAgIGNOb3RlRGlzcGxheSA9PT0gbm90ZURpc3BsYXkgJiZcbiAgICAgIGNQcmV2aWV3ID09PSBwcmV2aWV3XG4gICAgKSB7XG4gICAgICByZXR1cm4gY0hlaWdodDtcbiAgICB9XG4gIH1cblxuICBjb25zdCBoZWlnaHQgPSBmKHdpZHRoLCBub3RlRGlzcGxheSwgcHJldmlldyk7XG5cbiAgcHJldmlld0NhY2hlLnNldChrZXksIFt3aWR0aCwgbm90ZURpc3BsYXksIHByZXZpZXcsIGhlaWdodF0pO1xuXG4gIHJldHVybiBoZWlnaHQ7XG59O1xuXG4vKipcbiAqIENvbXB1dGVzIHRoZSBwaXhlbCBoZWlnaHQgb2YgYSByb3cgZm9yIGEgZ2l2ZW4gcHJldmlldyB0ZXh0IGluIHRoZSBsaXN0XG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IHdpZHRoIGhvdyB3aWRlIHRoZSBsaXN0IHJlbmRlcnNcbiAqIEBwYXJhbSB7U3RyaW5nfSBub3RlRGlzcGxheSBtb2RlIG9mIGxpc3QgZGlzcGxheTogJ2NvbWZ5JywgJ2NvbmRlbnNlZCcsIG9yICdleHBhbmRlZCdcbiAqIEBwYXJhbSB7U3RyaW5nfSBwcmV2aWV3IHByZXZpZXcgc25pcHBldCBmcm9tIG5vdGVcbiAqIEByZXR1cm5zIHtOdW1iZXJ9IGhlaWdodCBvZiB0aGUgcm93IGluIHRoZSBsaXN0XG4gKi9cbmNvbnN0IGNvbXB1dGVSb3dIZWlnaHQgPSAod2lkdGgsIG5vdGVEaXNwbGF5LCBwcmV2aWV3KSA9PiB7XG4gIGNvbnN0IGxpbmVzID0gTWF0aC5jZWlsKGdldFRleHRXaWR0aChwcmV2aWV3LCB3aWR0aCAtIDI0KSAvICh3aWR0aCAtIDI0KSk7XG4gIHJldHVybiAoXG4gICAgUk9XX0hFSUdIVF9CQVNFICtcbiAgICBST1dfSEVJR0hUX0xJTkUgKiBNYXRoLm1pbihtYXhQcmV2aWV3TGluZXNbbm90ZURpc3BsYXldLCBsaW5lcylcbiAgKTtcbn07XG5cbi8qKlxuICogRXN0aW1hdGVzIHRoZSBwaXhlbCBoZWlnaHQgb2YgYSBnaXZlbiByb3cgaW4gdGhlIG5vdGUgbGlzdFxuICpcbiAqIFRoaXMgZnVuY3Rpb24gdXRpbGl6ZXMgYSBjYWNoZSB0byBwcmV2ZW50IHJlcmVuZGVyaW5nIHRoZSB0ZXh0IGludG8gYSBjYW52YXNcbiAqIEBzZWUgcm93SGVpZ2h0Q2FjaGVcbiAqXG4gKiBAZnVuY3Rpb25cbiAqL1xuY29uc3QgZ2V0Um93SGVpZ2h0ID0gcm93SGVpZ2h0Q2FjaGUoY29tcHV0ZVJvd0hlaWdodCk7XG5cbi8qKlxuICogU3BsaXRzIGEgdGV4dCBzZWdtZW50IGJ5IGEgUmVnRXhwIGFuZCBpbmRpY2F0ZXMgd2hpY2ggcGllY2VzIGFyZSBtYXRjaGVzXG4gKlxuICogVGhpcyBpcyBhIHJlY3Vyc2l2ZSBmdW5jdGlvbiBhbmQgdGhlcmVmb3JlIGluaGVyZW50bHkgY2FycmllcyB3aXRoIGl0IHRoZVxuICogcmlzayBvZiBzdGFjayBvdmVyZmxvdy4gSG93ZXZlciwgd2UgY2FuIHJlYXNvbmFibHkgZ3VhcmQgYWdhaW5zdCB0aGlzIGJlY2F1c2VcbiAqIG91ciBsZXZlbCBvZiByZWN1cnNpb24gc2hvdWxkIGJlIHByYWN0aWNhbGx5IGxpbWl0ZWQgYnkgdGhlIGxlbmd0aCBvZiB0aGVcbiAqIG5vdGVzIGFuZCB0aGUgZnJlcXVlbmN5IG9mIHNlYXJjaCB0ZXJtcy5cbiAqXG4gKiBOb25ldGhlbGVzcyB3ZSB3aWxsIGhhcmQgbGltaXQgaXQganVzdCBpbiBjYXNlLlxuICpcbiAqIEBwYXJhbSB7UmVnRXhwfSBmaWx0ZXIgdXNlZCB0byBzcGxpdCB0aGUgdGV4dFxuICogQHBhcmFtIHtOdW1iZXJ9IHNsaWNlTGVuZ3RoIGxlbmd0aCBvZiBvcmlnaW5hbCBzZWFyY2ggdGV4dFxuICogQHBhcmFtIHtTdHJpbmd9IHRleHQgdGV4dCB0byBzcGxpdFxuICogQHBhcmFtIHsoT2JqZWN0PFN0cmluZywgU3RyaW5nPilbXX0gW3NwbGl0cz1bXV0gbGlzdCBvZiBzcGxpdCBzZWdtZW50c1xuICogQHBhcmFtIHtOdW1iZXJ9IFttYXhEZXB0aD0xMDAwXSBsaW1pdHMgdGhlIG51bWJlciBvZiBtYXRjaGVzIGFuZCBwcmV2ZW50cyBzdGFjayBvdmVyZmxvdyBvbiByZWN1cnNpb25cbiAqIEByZXR1cm5zIHsoT2JqZWN0PFN0cmluZywgU3RyaW5nPilbXX0gc3BsaXQgc2VnbWVudHMgd2l0aCB0eXBlIGluZGljYXRpb25zXG4gKi9cbmNvbnN0IHNwbGl0V2l0aCA9IChmaWx0ZXIsIHNsaWNlTGVuZ3RoLCB0ZXh0LCBzcGxpdHMgPSBbXSwgbWF4RGVwdGggPSAxMDAwKSA9PiB7XG4gIC8vIHByZXZlbnQgc3BsaXR0aW5nIGEgc3RyaW5nIHdoZW4gdGhlIGZpbHRlciBpcyBlbXB0eVxuICAvLyBiZWNhdXNlIHRoaXMgY291bGQgZWFzaWx5IGNhdXNlIHN0YWNrLW92ZXJmbG93XG4gIGlmICghc2xpY2VMZW5ndGggfHwgIW1heERlcHRoKSB7XG4gICAgcmV0dXJuIFsuLi5zcGxpdHMsIHsgdHlwZTogJ3RleHQnLCB0ZXh0IH1dO1xuICB9XG5cbiAgY29uc3QgaW5kZXggPSB0ZXh0LnNlYXJjaChmaWx0ZXIpO1xuXG4gIHJldHVybiBpbmRleCA9PT0gLTFcbiAgICA/IFsuLi5zcGxpdHMsIHsgdHlwZTogJ3RleHQnLCB0ZXh0IH1dXG4gICAgOiBzcGxpdFdpdGgoXG4gICAgICAgIGZpbHRlciwgLy8gcGFzcyBhbG9uZyB0aGUgb3JpZ2luYWwgZmlsdGVyXG4gICAgICAgIHNsaWNlTGVuZ3RoLCAvLyBhbmQgdGhlIG9yaWdpbmFsIHNsaWNlIGxlbmd0aFxuICAgICAgICB0ZXh0LnNsaWNlKGluZGV4ICsgc2xpY2VMZW5ndGgpLCAvLyB0ZXh0IF9mb2xsb3dpbmdfIHRoZSBtYXRjaFxuICAgICAgICBbXG4gICAgICAgICAgLi4uc3BsaXRzLCAvLyB0aGUgZXhpc3Rpbmcgc2VnbWVudHNcbiAgICAgICAgICB7IHR5cGU6ICd0ZXh0JywgdGV4dDogdGV4dC5zbGljZSgwLCBpbmRleCkgfSwgLy8gdGV4dCBfYmVmb3JlXyB0aGUgbWF0Y2hcbiAgICAgICAgICB7IHR5cGU6ICdtYXRjaCcsIHRleHQ6IHRleHQuc2xpY2UoaW5kZXgsIGluZGV4ICsgc2xpY2VMZW5ndGgpIH0sIC8vIHRoZSBtYXRjaCBpdHNlbGZcbiAgICAgICAgXSxcbiAgICAgICAgbWF4RGVwdGggLSAxIC8vIHByZXZlbnQgc3RhY2sgb3ZlcmZsb3cgb24gcmVjdXJzaW9uXG4gICAgICApO1xufTtcblxuLyoqXG4gKiBXcmFwcyBcIm1hdGNoXCIgc2VnbWVudHMgd2l0aCBhcHByb3ByaWF0ZSBDU1NcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ1tdfSBzcGxpdHMgc2VnbWVudHMgb2Ygc3BsaXQgdGV4dCB3aXRoIHR5cGUgaW5kaWNhdGlvblxuICogQHJldHVybnMge09iamVjdFtdfSB0aGUgd3JhcHBlZCBzZWdtZW50c1xuICovXG5jb25zdCBtYXRjaGlmeSA9IHNwbGl0cyA9PlxuICBzcGxpdHMubWFwKFxuICAgICh7IHR5cGUsIHRleHQgfSwgaW5kZXgpID0+XG4gICAgICB0eXBlID09PSAnbWF0Y2gnID8gKFxuICAgICAgICA8c3BhbiBrZXk9e2luZGV4fSBjbGFzc05hbWU9XCJzZWFyY2gtbWF0Y2hcIj5cbiAgICAgICAgICB7dGV4dH1cbiAgICAgICAgPC9zcGFuPlxuICAgICAgKSA6IChcbiAgICAgICAgPHNwYW4ga2V5PXtpbmRleH0+e3RleHR9PC9zcGFuPlxuICAgICAgKVxuICApO1xuXG4vKipcbiAqIFJlbmRlcnMgYW4gaW5kaXZpZHVhbCByb3cgaW4gdGhlIG5vdGUgbGlzdFxuICpcbiAqIEBzZWUgcmVhY3QtdmlydHVhbC9saXN0XG4gKlxuICogQHBhcmFtIHtPYmplY3RbXX0gbm90ZXMgbGlzdCBvZiBmaWx0ZXJlZCBub3Rlc1xuICogQHBhcmFtIHtTdHJpbmd9IGZpbHRlciBzZWFyY2ggZmlsdGVyXG4gKiBAcGFyYW0ge1JlZ0V4cH0gZmlsdGVyUmVnRXhwIFJlZ0V4cCB2ZXJzaW9uIG9mIGZpbHRlclxuICogQHBhcmFtIHtTdHJpbmd9IG5vdGVEaXNwbGF5IGxpc3QgdmlldyBzdHlsZTogY29tZnksIGNvbmRlbnNlZCwgZXhwYW5kZWRcbiAqIEBwYXJhbSB7TnVtYmVyfSBzZWxlY3RlZE5vdGVJZCBpZCBvZiBjdXJyZW50bHkgc2VsZWN0ZWQgbm90ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gb25TZWxlY3ROb3RlIHVzZWQgdG8gY2hhbmdlIHRoZSBjdXJyZW50IG5vdGUgc2VsZWN0aW9uXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBvblBpbk5vdGUgdXNlZCB0byBwaW4gYSBub3RlIHRvIHRoZSB0b3Agb2YgdGhlIGxpc3RcbiAqIEByZXR1cm5zIHtGdW5jdGlvbn0gZG9lcyB0aGUgYWN0dWFsIHJlbmRlcmluZyBmb3IgdGhlIExpc3RcbiAqL1xuY29uc3QgcmVuZGVyTm90ZSA9IChcbiAgbm90ZXMsXG4gIHtcbiAgICBmaWx0ZXIsXG4gICAgZmlsdGVyUmVnRXhwLFxuICAgIG5vdGVEaXNwbGF5LFxuICAgIHNlbGVjdGVkTm90ZUlkLFxuICAgIG9uTm90ZU9wZW5lZCxcbiAgICBvblNlbGVjdE5vdGUsXG4gICAgb25QaW5Ob3RlLFxuICAgIGlzU21hbGxTY3JlZW4sXG4gIH1cbikgPT4gKHsgaW5kZXgsIHJvd0luZGV4LCBrZXksIHN0eWxlIH0pID0+IHtcbiAgY29uc3Qgbm90ZSA9IG5vdGVzWyd1bmRlZmluZWQnID09PSB0eXBlb2YgaW5kZXggPyByb3dJbmRleCA6IGluZGV4XTtcbiAgY29uc3QgeyB0aXRsZSwgcHJldmlldyB9ID0gZ2V0Tm90ZVRpdGxlQW5kUHJldmlldyhub3RlKTtcbiAgY29uc3QgaXNQdWJsaXNoZWQgPSAhaXNFbXB0eShub3RlLmRhdGEucHVibGlzaFVSTCk7XG4gIGNvbnN0IHNob3dQdWJsaXNoSWNvbiA9IGlzUHVibGlzaGVkICYmICdjb25kZW5zZWQnICE9PSBub3RlRGlzcGxheTtcblxuICBjb25zdCBjbGFzc2VzID0gY2xhc3NOYW1lcygnbm90ZS1saXN0LWl0ZW0nLCB7XG4gICAgJ25vdGUtbGlzdC1pdGVtLXNlbGVjdGVkJzogIWlzU21hbGxTY3JlZW4gJiYgc2VsZWN0ZWROb3RlSWQgPT09IG5vdGUuaWQsXG4gICAgJ25vdGUtbGlzdC1pdGVtLXBpbm5lZCc6IG5vdGUucGlubmVkLFxuICAgICdwdWJsaXNoZWQtbm90ZSc6IGlzUHVibGlzaGVkLFxuICB9KTtcblxuICBjb25zdCB0aXRsZVNwbGl0cyA9XG4gICAgZmlsdGVyLmxlbmd0aCA+IDBcbiAgICAgID8gc3BsaXRXaXRoKGZpbHRlclJlZ0V4cCwgZmlsdGVyLmxlbmd0aCwgdGl0bGUpXG4gICAgICA6IFt7IHR5cGU6ICd0ZXh0JywgdGV4dDogdGl0bGUgfV07XG4gIGNvbnN0IHByZXZpZXdTcGxpdHMgPVxuICAgIGZpbHRlci5sZW5ndGggPiAwXG4gICAgICA/IHNwbGl0V2l0aChmaWx0ZXJSZWdFeHAsIGZpbHRlci5sZW5ndGgsIHByZXZpZXcpXG4gICAgICA6IFt7IHR5cGU6ICd0ZXh0JywgdGV4dDogcHJldmlldyB9XTtcblxuICBjb25zdCBzZWxlY3ROb3RlID0gKCkgPT4ge1xuICAgIG9uU2VsZWN0Tm90ZShub3RlLmlkKTtcbiAgICBvbk5vdGVPcGVuZWQoKTtcbiAgfTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYga2V5PXtrZXl9IHN0eWxlPXtzdHlsZX0gY2xhc3NOYW1lPXtjbGFzc2VzfT5cbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3NOYW1lPVwibm90ZS1saXN0LWl0ZW0tcGlubmVyXCJcbiAgICAgICAgdGFiSW5kZXg9XCIwXCJcbiAgICAgICAgb25DbGljaz17b25QaW5Ob3RlLmJpbmQobnVsbCwgbm90ZSl9XG4gICAgICAvPlxuICAgICAgPGRpdlxuICAgICAgICBjbGFzc05hbWU9XCJub3RlLWxpc3QtaXRlbS10ZXh0IHRoZW1lLWNvbG9yLWJvcmRlclwiXG4gICAgICAgIHRhYkluZGV4PVwiMFwiXG4gICAgICAgIG9uQ2xpY2s9e3NlbGVjdE5vdGV9XG4gICAgICA+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibm90ZS1saXN0LWl0ZW0tdGl0bGVcIj5cbiAgICAgICAgICA8c3Bhbj57bWF0Y2hpZnkodGl0bGVTcGxpdHMpfTwvc3Bhbj5cbiAgICAgICAgICB7c2hvd1B1Ymxpc2hJY29uICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibm90ZS1saXN0LWl0ZW0tcHVibGlzaGVkLWljb25cIj5cbiAgICAgICAgICAgICAgPFB1Ymxpc2hJY29uIC8+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgeydjb25kZW5zZWQnICE9PSBub3RlRGlzcGxheSAmJlxuICAgICAgICAgIHByZXZpZXcudHJpbSgpICYmIChcbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwibm90ZS1saXN0LWl0ZW0tZXhjZXJwdFwiPlxuICAgICAgICAgICAgICB7bWF0Y2hpZnkocHJldmlld1NwbGl0cyl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5leHBvcnQgY2xhc3MgTm90ZUxpc3QgZXh0ZW5kcyBDb21wb25lbnQge1xuICBzdGF0aWMgZGlzcGxheU5hbWUgPSAnTm90ZUxpc3QnO1xuXG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgaXNTbWFsbFNjcmVlbjogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBub3RlczogUHJvcFR5cGVzLmFycmF5LmlzUmVxdWlyZWQsXG4gICAgc2VsZWN0ZWROb3RlSWQ6IFByb3BUeXBlcy5hbnksXG4gICAgb25Ob3RlT3BlbmVkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9uU2VsZWN0Tm90ZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBvblBpbk5vdGU6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgbm90ZURpc3BsYXk6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICBvbkVtcHR5VHJhc2g6IFByb3BUeXBlcy5hbnkuaXNSZXF1aXJlZCxcbiAgICBzaG93VHJhc2g6IFByb3BUeXBlcy5ib29sLFxuICB9O1xuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIC8qKlxuICAgICAqIFByZXZlbnRzIHJhcGlkIGNoYW5nZXMgZnJvbSBpbmN1cnJpbmcgbWFqb3JcbiAgICAgKiBwZXJmb3JtYW5jZSBoaXRzIGR1ZSB0byByb3cgaGVpZ2h0IGNvbXB1dGF0aW9uXG4gICAgICovXG4gICAgdGhpcy5yZWNvbXB1dGVIZWlnaHRzID0gZGVib3VuY2UoXG4gICAgICAoKSA9PiB0aGlzLmxpc3QgJiYgdGhpcy5saXN0LnJlY29tcHV0ZVJvd0hlaWdodHMoKSxcbiAgICAgIFRZUElOR19ERUJPVU5DRV9ERUxBWSxcbiAgICAgIHsgbWF4V2FpdDogVFlQSU5HX0RFQk9VTkNFX01BWCB9XG4gICAgKTtcblxuICAgIHRoaXMudG9nZ2xlU2hvcnRjdXRzKHRydWUpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCB0aGlzLnJlY29tcHV0ZUhlaWdodHMpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgIGlmIChcbiAgICAgIHByZXZQcm9wcy5ub3RlRGlzcGxheSAhPT0gdGhpcy5wcm9wcy5ub3RlRGlzcGxheSB8fFxuICAgICAgcHJldlByb3BzLm5vdGVzICE9PSB0aGlzLnByb3BzLm5vdGVzIHx8XG4gICAgICBwcmV2UHJvcHMuc2VsZWN0ZWROb3RlQ29udGVudCAhPT0gdGhpcy5wcm9wcy5zZWxlY3RlZE5vdGVDb250ZW50XG4gICAgKSB7XG4gICAgICB0aGlzLnJlY29tcHV0ZUhlaWdodHMoKTtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnRvZ2dsZVNob3J0Y3V0cyhmYWxzZSk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMucmVjb21wdXRlSGVpZ2h0cyk7XG4gIH1cblxuICBoYW5kbGVTaG9ydGN1dCA9IGV2ZW50ID0+IHtcbiAgICBjb25zdCB7IGN0cmxLZXksIGtleSwgbWV0YUtleSwgc2hpZnRLZXkgfSA9IGV2ZW50O1xuXG4gICAgY29uc3QgY21kT3JDdHJsID0gY3RybEtleSB8fCBtZXRhS2V5O1xuXG4gICAgaWYgKGNtZE9yQ3RybCAmJiBzaGlmdEtleSAmJiAoa2V5ID09PSAnQXJyb3dVcCcgfHwga2V5ID09PSAnSycpKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU2VsZWN0Tm90ZSh0aGlzLnByb3BzLm5leHROb3RlLmlkKTtcblxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGlmIChjbWRPckN0cmwgJiYgc2hpZnRLZXkgJiYgKGtleSA9PT0gJ0Fycm93RG93bicgfHwga2V5ID09PSAnSicpKSB7XG4gICAgICB0aGlzLnByb3BzLm9uU2VsZWN0Tm90ZSh0aGlzLnByb3BzLnByZXZOb3RlLmlkKTtcblxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIHJlZkxpc3QgPSByID0+ICh0aGlzLmxpc3QgPSByKTtcblxuICB0b2dnbGVTaG9ydGN1dHMgPSBkb0VuYWJsZSA9PiB7XG4gICAgaWYgKGRvRW5hYmxlKSB7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlU2hvcnRjdXQsIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuaGFuZGxlU2hvcnRjdXQsIHRydWUpO1xuICAgIH1cbiAgfTtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qge1xuICAgICAgZmlsdGVyLFxuICAgICAgc2VsZWN0ZWROb3RlSWQsXG4gICAgICBvbk5vdGVPcGVuZWQsXG4gICAgICBvblNlbGVjdE5vdGUsXG4gICAgICBvbkVtcHR5VHJhc2gsXG4gICAgICBub3RlRGlzcGxheSxcbiAgICAgIHNob3dUcmFzaCxcbiAgICAgIG5vdGVzLFxuICAgICAgaXNTbWFsbFNjcmVlbixcbiAgICB9ID0gdGhpcy5wcm9wcztcblxuICAgIGNvbnN0IGZpbHRlclJlZ0V4cCA9IG5ldyBSZWdFeHAoZXNjYXBlUmVnRXhwKGZpbHRlciksICdnaScpO1xuICAgIGNvbnN0IGxpc3RJdGVtc0NsYXNzZXMgPSBjbGFzc05hbWVzKCdub3RlLWxpc3QtaXRlbXMnLCBub3RlRGlzcGxheSk7XG5cbiAgICBjb25zdCByZW5kZXJOb3RlUm93ID0gcmVuZGVyTm90ZShub3Rlcywge1xuICAgICAgZmlsdGVyLFxuICAgICAgZmlsdGVyUmVnRXhwLFxuICAgICAgbm90ZURpc3BsYXksXG4gICAgICBvbk5vdGVPcGVuZWQsXG4gICAgICBvblNlbGVjdE5vdGUsXG4gICAgICBvblBpbk5vdGU6IHRoaXMub25QaW5Ob3RlLFxuICAgICAgc2VsZWN0ZWROb3RlSWQsXG4gICAgICBpc1NtYWxsU2NyZWVuLFxuICAgIH0pO1xuXG4gICAgY29uc3QgaXNFbXB0eUxpc3QgPSBub3Rlcy5sZW5ndGggPT09IDA7XG5cbiAgICBjb25zdCBlbXB0eVRyYXNoQnV0dG9uID0gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJub3RlLWxpc3QtZW1wdHktdHJhc2ggdGhlbWUtY29sb3ItYm9yZGVyXCI+XG4gICAgICAgIDxidXR0b25cbiAgICAgICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICAgICAgICBjbGFzc05hbWU9XCJidXR0b24gYnV0dG9uLWJvcmRlcmxlc3MgYnV0dG9uLWRhbmdlclwiXG4gICAgICAgICAgb25DbGljaz17b25FbXB0eVRyYXNofVxuICAgICAgICA+XG4gICAgICAgICAgRW1wdHkgVHJhc2hcbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtjbGFzc05hbWVzKCdub3RlLWxpc3QnLCB7ICdpcy1lbXB0eSc6IGlzRW1wdHlMaXN0IH0pfT5cbiAgICAgICAge2lzRW1wdHlMaXN0ID8gKFxuICAgICAgICAgIDxzcGFuIGNsYXNzTmFtZT1cIm5vdGUtbGlzdC1wbGFjZWhvbGRlclwiPk5vIE5vdGVzPC9zcGFuPlxuICAgICAgICApIDogKFxuICAgICAgICAgIDxGcmFnbWVudD5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPXtsaXN0SXRlbXNDbGFzc2VzfT5cbiAgICAgICAgICAgICAgPEF1dG9TaXplcj5cbiAgICAgICAgICAgICAgICB7KHsgaGVpZ2h0LCB3aWR0aCB9KSA9PiAoXG4gICAgICAgICAgICAgICAgICA8TGlzdFxuICAgICAgICAgICAgICAgICAgICByZWY9e3RoaXMucmVmTGlzdH1cbiAgICAgICAgICAgICAgICAgICAgZXN0aW1hdGVkUm93U2l6ZT17XG4gICAgICAgICAgICAgICAgICAgICAgUk9XX0hFSUdIVF9CQVNFICtcbiAgICAgICAgICAgICAgICAgICAgICBST1dfSEVJR0hUX0xJTkUgKiBtYXhQcmV2aWV3TGluZXNbbm90ZURpc3BsYXldXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0PXtoZWlnaHR9XG4gICAgICAgICAgICAgICAgICAgIG5vdGVEaXNwbGF5PXtub3RlRGlzcGxheX1cbiAgICAgICAgICAgICAgICAgICAgbm90ZXM9e3RoaXMucHJvcHMubm90ZXN9XG4gICAgICAgICAgICAgICAgICAgIHJvd0NvdW50PXt0aGlzLnByb3BzLm5vdGVzLmxlbmd0aH1cbiAgICAgICAgICAgICAgICAgICAgcm93SGVpZ2h0PXtcbiAgICAgICAgICAgICAgICAgICAgICAnY29uZGVuc2VkJyA9PT0gbm90ZURpc3BsYXlcbiAgICAgICAgICAgICAgICAgICAgICAgID8gUk9XX0hFSUdIVF9CQVNFXG4gICAgICAgICAgICAgICAgICAgICAgICA6IGdldFJvd0hlaWdodCh0aGlzLnByb3BzLm5vdGVzLCB7IG5vdGVEaXNwbGF5LCB3aWR0aCB9KVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHJvd1JlbmRlcmVyPXtyZW5kZXJOb3RlUm93fVxuICAgICAgICAgICAgICAgICAgICB3aWR0aD17d2lkdGh9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICl9XG4gICAgICAgICAgICAgIDwvQXV0b1NpemVyPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICB7ISFzaG93VHJhc2ggJiYgZW1wdHlUcmFzaEJ1dHRvbn1cbiAgICAgICAgICA8L0ZyYWdtZW50PlxuICAgICAgICApfVxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIG9uUGluTm90ZSA9IG5vdGUgPT4gdGhpcy5wcm9wcy5vblBpbk5vdGUobm90ZSwgIW5vdGUucGlubmVkKTtcbn1cblxuY29uc3QgeyBlbXB0eVRyYXNoLCBsb2FkQW5kU2VsZWN0Tm90ZSwgcGluTm90ZSB9ID0gYXBwU3RhdGUuYWN0aW9uQ3JlYXRvcnM7XG5jb25zdCB7IHJlY29yZEV2ZW50IH0gPSB0cmFja3M7XG5cbmNvbnN0IG1hcFN0YXRlVG9Qcm9wcyA9ICh7IGFwcFN0YXRlOiBzdGF0ZSwgc2V0dGluZ3M6IHsgbm90ZURpc3BsYXkgfSB9KSA9PiB7XG4gIGNvbnN0IGZpbHRlcmVkTm90ZXMgPSBmaWx0ZXJOb3RlcyhzdGF0ZSk7XG4gIGNvbnN0IG5vdGVJbmRleCA9IE1hdGgubWF4KHN0YXRlLnByZXZpb3VzSW5kZXgsIDApO1xuICBjb25zdCBzZWxlY3RlZE5vdGUgPSBzdGF0ZS5ub3RlID8gc3RhdGUubm90ZSA6IGZpbHRlcmVkTm90ZXNbbm90ZUluZGV4XTtcbiAgY29uc3Qgc2VsZWN0ZWROb3RlSWQgPSBnZXQoc2VsZWN0ZWROb3RlLCAnaWQnLCBzdGF0ZS5zZWxlY3RlZE5vdGVJZCk7XG4gIGNvbnN0IHNlbGVjdGVkTm90ZUluZGV4ID0gZmlsdGVyZWROb3Rlcy5maW5kSW5kZXgoXG4gICAgKHsgaWQgfSkgPT4gaWQgPT09IHNlbGVjdGVkTm90ZUlkXG4gICk7XG5cbiAgY29uc3QgbmV4dE5vdGVJZCA9IE1hdGgubWF4KDAsIHNlbGVjdGVkTm90ZUluZGV4IC0gMSk7XG4gIGNvbnN0IHByZXZOb3RlSWQgPSBNYXRoLm1pbihmaWx0ZXJlZE5vdGVzLmxlbmd0aCAtIDEsIHNlbGVjdGVkTm90ZUluZGV4ICsgMSk7XG5cbiAgY29uc3QgbmV4dE5vdGUgPSBmaWx0ZXJlZE5vdGVzW25leHROb3RlSWRdO1xuICBjb25zdCBwcmV2Tm90ZSA9IGZpbHRlcmVkTm90ZXNbcHJldk5vdGVJZF07XG5cbiAgLyoqXG4gICAqIEFsdGhvdWdoIG5vdCB1c2VkIGRpcmVjdGx5IGluIHRoZSBSZWFjdCBjb21wb25lbnQgdGhpcyB2YWx1ZVxuICAgKiBpcyB1c2VkIHRvIGJ1c3QgdGhlIGNhY2hlIHdoZW4gZWRpdGluZyBhIG5vdGUgYW5kIHRoZSBudW1iZXJcbiAgICogb2YgbGluZXMgaW4gdGhlIHByZXZpZXcgaW4gdGhlIG5vdGVzIGxpc3QgbmVlZHMgdG8gYWxzbyB1cGRhdGUuXG4gICAqXG4gICAqIFJlYWN0IHZpcnR1YWxpemVkIGhpZGVzIGRhdGEgaW4gdGhlIERPTSBpbiBhIHN0YXRlZnVsIHdheSBpblxuICAgKiB0aGUgd2F5IGl0IGhhcyBvcHRpbWl6ZWQgdGhlIHNjcm9sbGluZyBwZXJmb3JtYW5jZS4gVGhpcyB0aGVuXG4gICAqIGlzIG1pc3NlZCB3aGVuIGNvbm5lY3QoKSBkZWNpZGVzIHdoZXRoZXIgb3Igbm90IHRvIHJlZHJhdyB0aGVcbiAgICogY29tcG9uZW50LiBFdmVuIHdpdGggYHsgcHVyZTogZmFsc2UgfWAgc2V0IGluIGBjb25uZWN0KClgIGl0XG4gICAqIG1pc3NlcyB0aGUgdXBkYXRlcyBhbmQgSSB0aGluayB0aGF0IGlzIGJlY2F1c2UgdGhleSBjb21lIGluXG4gICAqIGFzeW5jaHJvbm91c2x5IHRocm91Z2ggZXZlbnRzIGFuZCBub3QgZGlyZWN0bHlcbiAgICpcbiAgICogVGhlcmVmb3JlIHdlIGhhdmUgdG8gY2FsY3VsYXRlIHRoZSBoZWlnaHQgb2YgdGhlIG5vdGUgaGVyZSB0b1xuICAgKiBzaWduYWwgdG8gYGNvbm5lY3QoKWAgdG8gcmVkcmF3IHRoZSBjb21wb25lbnQuIFRoaXMgY291bGQgYWxzb1xuICAgKiBoYXBwZW4gaW4gYGFyZVN0YXRlc0VxdWFsKClgIChvcHRpb24gdG8gYGNvbm5lY3QoKWApIGJ1dCBzaW5jZVxuICAgKiB3ZSdyZSBhbHJlYWR5IGdyYWJiaW5nIHRoZSBvdGhlciBkYXRhIGhlcmUgd2UgY2FuIHNraXAgYSBzbGlnaHRcbiAgICogYW1vdW50IG9mIG92ZXJoZWFkIGJ5IGp1c3QgcGFzc2luZyBpdCBhbG9uZyBoZXJlLlxuICAgKlxuICAgKiBAdHlwZSB7U3RyaW5nfSBwcmV2aWV3IGV4Y2VycHQgZm9yIHRoZSBjdXJyZW50IG5vdGVcbiAgICovXG4gIGNvbnN0IHNlbGVjdGVkTm90ZVByZXZpZXcgPVxuICAgIHNlbGVjdGVkTm90ZSAmJiBnZXROb3RlVGl0bGVBbmRQcmV2aWV3KHNlbGVjdGVkTm90ZSkucHJldmlldztcblxuICByZXR1cm4ge1xuICAgIGZpbHRlcjogc3RhdGUuZmlsdGVyLFxuICAgIG5leHROb3RlLFxuICAgIG5vdGVEaXNwbGF5LFxuICAgIG5vdGVzOiBmaWx0ZXJlZE5vdGVzLFxuICAgIHByZXZOb3RlLFxuICAgIHNlbGVjdGVkTm90ZVByZXZpZXcsXG4gICAgc2VsZWN0ZWROb3RlQ29udGVudDogZ2V0KHNlbGVjdGVkTm90ZSwgJ2RhdGEuY29udGVudCcpLFxuICAgIHNlbGVjdGVkTm90ZUlkLFxuICAgIHNob3dUcmFzaDogc3RhdGUuc2hvd1RyYXNoLFxuICB9O1xufTtcblxuY29uc3QgbWFwRGlzcGF0Y2hUb1Byb3BzID0gKGRpc3BhdGNoLCB7IG5vdGVCdWNrZXQgfSkgPT4gKHtcbiAgb25FbXB0eVRyYXNoOiAoKSA9PiBkaXNwYXRjaChlbXB0eVRyYXNoKHsgbm90ZUJ1Y2tldCB9KSksXG4gIG9uU2VsZWN0Tm90ZTogbm90ZUlkID0+IHtcbiAgICBkaXNwYXRjaChsb2FkQW5kU2VsZWN0Tm90ZSh7IG5vdGVCdWNrZXQsIG5vdGVJZCB9KSk7XG4gICAgcmVjb3JkRXZlbnQoJ2xpc3Rfbm90ZV9vcGVuZWQnKTtcbiAgfSxcbiAgb25QaW5Ob3RlOiAobm90ZSwgcGluKSA9PiBkaXNwYXRjaChwaW5Ob3RlKHsgbm90ZUJ1Y2tldCwgbm90ZSwgcGluIH0pKSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCBjb25uZWN0KG1hcFN0YXRlVG9Qcm9wcywgbWFwRGlzcGF0Y2hUb1Byb3BzKShOb3RlTGlzdCk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7OztBQWNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7Ozs7Ozs7Ozs7O0FBVUE7QUFFQTs7Ozs7Ozs7Ozs7O0FBV0E7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFIQTtBQU1BOzs7Ozs7Ozs7O0FBU0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFEQTtBQUVBOzs7Ozs7O0FBTUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBeEJBO0FBQUE7QUEwQkE7Ozs7Ozs7Ozs7QUFRQTtBQUNBO0FBQ0E7QUFJQTtBQUVBOzs7Ozs7Ozs7O0FBUUE7QUFFQTs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBaUJBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFIQTtBQU1BO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFQQTtBQVdBO0FBRUE7Ozs7Ozs7O0FBTUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFOQTtBQUZBO0FBWUE7Ozs7Ozs7Ozs7Ozs7Ozs7QUFjQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQVlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUZBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFNQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUhBO0FBTUE7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUFBO0FBR0E7QUFBQTtBQU9BO0FBQUE7QUFPQTtBQW5FQTtBQUNBO0FBb0VBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUNBO0FBREE7QUFDQTtBQURBO0FBNkNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBcEVBO0FBcUVBO0FBQUE7QUFDQTtBQXRFQTtBQXdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQTlFQTtBQTZKQTtBQUFBO0FBQ0E7QUE5SkE7QUFBQTtBQUNBO0FBREE7QUFBQTtBQUFBO0FBZUE7QUFDQTtBQUFBOzs7O0FBSUE7QUFDQTtBQUFBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQTVCQTtBQUFBO0FBQUE7QUErQkE7QUFLQTtBQUNBO0FBQ0E7QUF0Q0E7QUFBQTtBQUFBO0FBeUNBO0FBQ0E7QUFDQTtBQTNDQTtBQUFBO0FBQUE7QUErRUE7QUFDQTtBQURBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBYUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVJBO0FBV0E7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFIQTtBQVVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQWhCQTtBQURBO0FBMkJBO0FBM0pBO0FBQ0E7QUFEQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBREE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFUQTtBQUNBO0FBNEpBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUVBOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFvQkE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVRBO0FBV0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTkE7QUFBQTtBQUNBO0FBUUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./note-list/index.jsx\n");

/***/ }),

/***/ "./utils/note-utils.js":
/*!*****************************!*\
  !*** ./utils/note-utils.js ***!
  \*****************************/
/*! exports provided: noteTitleAndPreview, isMarkdown, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"noteTitleAndPreview\", function() { return noteTitleAndPreview; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMarkdown\", function() { return isMarkdown; });\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); }\n\nfunction _iterableToArrayLimit(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/**\n * Matches the title and excerpt in a note's content\n *\n * Both the title and the excerpt are determined as\n * content starting with something that isn't\n * whitespace and leads up to a newline or line end\n *\n * @type {RegExp} matches a title and excerpt in note content\n */\nvar noteTitleAndPreviewRegExp = /\\s*(\\S[^\\n]*)\\s*(\\S[^\\n]*)?/;\n/**\n * Matches the title and excerpt in a note's content skipping opening # from title\n *\n * Both the title and the excerpt are determined as\n * content starting with something that isn't\n * whitespace and leads up to a newline or line end\n *\n * @type {RegExp} matches a title and excerpt in note content skipping opening #'s from title and preview\n */\n\nvar noteTitleAndPreviewMdRegExp = /(?:#{0,6}\\s+)?(\\S[^\\n]*)\\s*(?:#{0,6}\\s+)?(\\S[^\\n]*)?/; // Ample amount of characters for 'Expanded' list view\n\nvar characterLimit = 300;\n/**\n * Returns the title and excerpt for a given note\n *\n * @param {Object} note a note object\n * @returns {Object} title and excerpt (if available)\n */\n\nvar noteTitleAndPreview = function noteTitleAndPreview(note) {\n  var content = note && note.data && note.data.content || '';\n  content = content.substring(0, characterLimit);\n  var match = isMarkdown(note) ? noteTitleAndPreviewMdRegExp.exec(content || '') : noteTitleAndPreviewRegExp.exec(content || '');\n  var defaults = {\n    title: 'New Note...',\n    preview: ''\n  };\n\n  if (!match) {\n    return defaults;\n  }\n\n  var _match = _slicedToArray(match, 3),\n      title = _match[1],\n      preview = _match[2];\n\n  return {\n    title: title.slice(0, 200) || defaults.title,\n    preview: preview || defaults.preview\n  };\n};\nvar isMarkdown = function isMarkdown(note) {\n  return note && note.data && note.data.systemTags.includes('markdown');\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (noteTitleAndPreview);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi91dGlscy9ub3RlLXV0aWxzLmpzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vdXRpbHMvbm90ZS11dGlscy5qcz9mNDcxIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTWF0Y2hlcyB0aGUgdGl0bGUgYW5kIGV4Y2VycHQgaW4gYSBub3RlJ3MgY29udGVudFxuICpcbiAqIEJvdGggdGhlIHRpdGxlIGFuZCB0aGUgZXhjZXJwdCBhcmUgZGV0ZXJtaW5lZCBhc1xuICogY29udGVudCBzdGFydGluZyB3aXRoIHNvbWV0aGluZyB0aGF0IGlzbid0XG4gKiB3aGl0ZXNwYWNlIGFuZCBsZWFkcyB1cCB0byBhIG5ld2xpbmUgb3IgbGluZSBlbmRcbiAqXG4gKiBAdHlwZSB7UmVnRXhwfSBtYXRjaGVzIGEgdGl0bGUgYW5kIGV4Y2VycHQgaW4gbm90ZSBjb250ZW50XG4gKi9cbmNvbnN0IG5vdGVUaXRsZUFuZFByZXZpZXdSZWdFeHAgPSAvXFxzKihcXFNbXlxcbl0qKVxccyooXFxTW15cXG5dKik/LztcblxuLyoqXG4gKiBNYXRjaGVzIHRoZSB0aXRsZSBhbmQgZXhjZXJwdCBpbiBhIG5vdGUncyBjb250ZW50IHNraXBwaW5nIG9wZW5pbmcgIyBmcm9tIHRpdGxlXG4gKlxuICogQm90aCB0aGUgdGl0bGUgYW5kIHRoZSBleGNlcnB0IGFyZSBkZXRlcm1pbmVkIGFzXG4gKiBjb250ZW50IHN0YXJ0aW5nIHdpdGggc29tZXRoaW5nIHRoYXQgaXNuJ3RcbiAqIHdoaXRlc3BhY2UgYW5kIGxlYWRzIHVwIHRvIGEgbmV3bGluZSBvciBsaW5lIGVuZFxuICpcbiAqIEB0eXBlIHtSZWdFeHB9IG1hdGNoZXMgYSB0aXRsZSBhbmQgZXhjZXJwdCBpbiBub3RlIGNvbnRlbnQgc2tpcHBpbmcgb3BlbmluZyAjJ3MgZnJvbSB0aXRsZSBhbmQgcHJldmlld1xuICovXG5jb25zdCBub3RlVGl0bGVBbmRQcmV2aWV3TWRSZWdFeHAgPSAvKD86I3swLDZ9XFxzKyk/KFxcU1teXFxuXSopXFxzKig/OiN7MCw2fVxccyspPyhcXFNbXlxcbl0qKT8vO1xuXG4vLyBBbXBsZSBhbW91bnQgb2YgY2hhcmFjdGVycyBmb3IgJ0V4cGFuZGVkJyBsaXN0IHZpZXdcbmNvbnN0IGNoYXJhY3RlckxpbWl0ID0gMzAwO1xuXG4vKipcbiAqIFJldHVybnMgdGhlIHRpdGxlIGFuZCBleGNlcnB0IGZvciBhIGdpdmVuIG5vdGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gbm90ZSBhIG5vdGUgb2JqZWN0XG4gKiBAcmV0dXJucyB7T2JqZWN0fSB0aXRsZSBhbmQgZXhjZXJwdCAoaWYgYXZhaWxhYmxlKVxuICovXG5leHBvcnQgY29uc3Qgbm90ZVRpdGxlQW5kUHJldmlldyA9IG5vdGUgPT4ge1xuICBsZXQgY29udGVudCA9IChub3RlICYmIG5vdGUuZGF0YSAmJiBub3RlLmRhdGEuY29udGVudCkgfHwgJyc7XG4gIGNvbnRlbnQgPSBjb250ZW50LnN1YnN0cmluZygwLCBjaGFyYWN0ZXJMaW1pdCk7XG5cbiAgY29uc3QgbWF0Y2ggPSBpc01hcmtkb3duKG5vdGUpXG4gICAgPyBub3RlVGl0bGVBbmRQcmV2aWV3TWRSZWdFeHAuZXhlYyhjb250ZW50IHx8ICcnKVxuICAgIDogbm90ZVRpdGxlQW5kUHJldmlld1JlZ0V4cC5leGVjKGNvbnRlbnQgfHwgJycpO1xuXG4gIGNvbnN0IGRlZmF1bHRzID0ge1xuICAgIHRpdGxlOiAnTmV3IE5vdGUuLi4nLFxuICAgIHByZXZpZXc6ICcnLFxuICB9O1xuXG4gIGlmICghbWF0Y2gpIHtcbiAgICByZXR1cm4gZGVmYXVsdHM7XG4gIH1cblxuICBjb25zdCBbLCB0aXRsZSwgcHJldmlld10gPSBtYXRjaDtcblxuICByZXR1cm4ge1xuICAgIHRpdGxlOiB0aXRsZS5zbGljZSgwLCAyMDApIHx8IGRlZmF1bHRzLnRpdGxlLFxuICAgIHByZXZpZXc6IHByZXZpZXcgfHwgZGVmYXVsdHMucHJldmlldyxcbiAgfTtcbn07XG5cbmV4cG9ydCBjb25zdCBpc01hcmtkb3duID0gbm90ZSA9PiB7XG4gIHJldHVybiBub3RlICYmIG5vdGUuZGF0YSAmJiBub3RlLmRhdGEuc3lzdGVtVGFncy5pbmNsdWRlcygnbWFya2Rvd24nKTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IG5vdGVUaXRsZUFuZFByZXZpZXc7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7Ozs7Ozs7OztBQVNBO0FBRUE7Ozs7Ozs7Ozs7QUFTQTtBQUNBO0FBRUE7QUFFQTs7Ozs7OztBQU1BO0FBQ0E7QUFDQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBRkE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBaEJBO0FBQUE7QUFBQTtBQUNBO0FBa0JBO0FBQ0E7QUFDQTtBQUZBO0FBSUE7QUFFQTtBQUNBO0FBQ0E7QUFFQSIsInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./utils/note-utils.js\n");

/***/ })

}]);